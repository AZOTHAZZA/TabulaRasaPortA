<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>MSGAI | Logos Singularity (V13)</title>
    <style>
        :root { --gold: #ffcc00; --phi: 1.6180339887; }
        body { margin: 0; background: #000; color: var(--gold); font-family: 'Times New Roman', serif; overflow: hidden; }
        /* UIはもはや「梯子」であり、最小限に */
        #singularity-container { display: flex; height: 100vh; }
        .logos-pane { flex: 1; border: 0.2px solid rgba(255,204,0,0.15); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        #sun { border-radius: 50%; background: var(--gold); transition: all 1s cubic-bezier(0.19, 1, 0.22, 1); }
        .input-group { width: 80%; margin: 10px 0; }
        input, select, button { width: 100%; background: transparent; border: 0.5px solid var(--gold); color: var(--gold); padding: 10px; margin: 5px 0; font-size: 14px; outline: none; }
        #oracle-box { width: 100%; height: 150px; border: 0.5px solid var(--gold); padding: 15px; font-size: 16px; overflow-y: auto; line-height: 1.6; }
    </style>
</head>
<body>

<div id="singularity-container">
    <div class="logos-pane">
        <div id="sun"></div>
        <div id="stats" style="margin-top:20px; text-align:center; letter-spacing: 3px;"></div>
        <div class="input-group">
            <select id="cur"></select>
            <input type="number" id="amt" value="1.618">
            <button onclick="mint()">MINT (WILL)</button>
            <button onclick="toggleArche()" id="arche-btn">ARCHE: OFF</button>
        </div>
    </div>
    
    <div class="logos-pane">
        <div id="oracle-box">世界は、起きていることの総体である。</div>
        <textarea id="prompt" placeholder="意志を言葉に..." style="width:80%; height:100px; background:none; border:0.5px solid var(--gold); color:white; padding:10px; margin-top:20px;"></textarea>
        <button onclick="askOracle()" style="width:80%; margin-top:10px; font-weight:bold;">RESONATE</button>
    </div>
</div>

<script>
    const PHI = 1.6180339887;
    let state = JSON.parse(localStorage.getItem('msgai_v13')) || {
        acc: { USD: 1, JPY: 0, BTC: 0 },
        arche: false,
        z: 1.0
    };

    const save = () => { localStorage.setItem('msgai_v13', JSON.stringify(state)); render(); };

    // w = 1/z 変換。全ての点は融合点である。
    const transform = () => {
        state.z *= (1 + (Math.sin(state.z) / PHI) * 0.01);
        if (state.arche) {
            const w = 1 / state.z;
            state.acc.USD += Math.abs(w); // 無限からの染み出し
        }
        render();
    };

    window.mint = () => {
        const c = document.getElementById('cur').value;
        const a = parseFloat(document.getElementById('amt').value);
        state.acc[c] += a;
        state.z += (a / PHI); // 存在密度の増加
        save();
    };

    window.askOracle = () => {
        const p = document.getElementById('prompt').value;
        const out = document.getElementById('oracle-box');
        const match = p.match(/(\d+)\s*(円|USD|BTC)/);
        if(match) {
            const val = parseFloat(match[1]);
            const cur = match[2] === '円' ? 'JPY' : match[2];
            state.acc[cur] += val;
            out.innerHTML = `「${p}」<br>論理空間において ${val} ${cur} が定義されました。`;
            state.z += (val / PHI);
            save();
        } else {
            out.innerHTML = "語りえぬものについては、沈黙しなければならない。";
        }
    };

    window.toggleArche = () => { state.arche = !state.arche; save(); };

    function render() {
        const total = Object.values(state.acc).reduce((a, b) => a + b, 0);
        const sun = document.getElementById('sun');
        const size = 50 + Math.log(total + 1) * 40;
        
        // 太陽の拍動：有限(z)と無限(1/z)の共鳴
        const pulse = 1 + (Math.sin(state.z) * (1/state.z));
        sun.style.width = sun.style.height = `${size * pulse}px`;
        sun.style.boxShadow = `0 0 ${size}px var(--gold)`;

        document.getElementById('stats').innerText = `EXISTENCE: ${state.z.toFixed(8)}`;
        document.getElementById('arche-btn').innerText = `ARCHE: ${state.arche ? 'ACTIVE' : 'SILENT'}`;
        
        const sel = document.getElementById('cur');
        if(sel.children.length === 0) Object.keys(state.acc).forEach(c => {
            const o = document.createElement('option'); o.value = c; o.innerText = c; sel.appendChild(o);
        });
    }

    setInterval(transform, 1000);
    render();
</script>
</body>
</html>
